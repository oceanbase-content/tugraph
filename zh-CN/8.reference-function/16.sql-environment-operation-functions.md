# SQL 环境操作相关函数

## SQLEnvGet

**函数功能** ：返回指向与给定 SQLLIB 运行时上下文关联的 OCI 环境句柄的指针。

**函数原型** ：

```C++
sword SQLEnvGet(dvoid *rctx, OCIEnv **oeh);
```

**函数参数** ：

|    参数      |                描述                                  |
|--------------|-----------------------------------------------------|
| rctx (IN)    |  指向 SQLLIB 运行时上下文的指针                       |
| oeh (OUT)    | 指向环境句柄的指针                                    |

**返回值**：成功时返回 SQL_SUCCESS，失败时返回 SQL_ERROR。

> **注意**
>
> ECOB/C++ 中常见的错误状态变量，例如 SQLCA 和 SQLSTATE 不会受到对该函数调用的影响。

## SQLSvcCtxGet

**函数功能**：返回 ECOB/C++ 数据库连接的 OCI 服务上下文，之后可以在对 OCI 函数的直接调用中使用 OCI 服务上下文。

**函数原型**：

```C++
sword SQLSvcCtxGet(dvoid *rctx, text *dbname,
       sb4 dbnamelen, OCISvcCtx **svc);
```

**函数参数** ：

|    参数      |                描述                                  |
|--------------|-----------------------------------------------------|
| rctx (IN)    |  指向 SQLLIB 运行时上下文的指针                       |
| dbname (IN)    | 连接的缓冲区（包含 logical 名），与嵌入式 SQL 语句中 AT 字句中使用的标识符相同                |
| dbnamelen (IN) | `dbname` 缓冲区的长度，取值为 `-1` 时表示 dbname 是一个以零结尾的字符串                      |
| svc (OUT)     | OCISvcCtx 指针的地址                                    |

**返回值**：成功时返回 SQL_SUCCESS，失败时返回 SQL_ERROR。

> **说明**
>
> * ECOB/C++ 中常见的错误状态变量，例如 SQLCA 和 SQLSTATE 不会受到对该函数调用的影响。
>
> * 如果 `dbname` 为空指针或 `dbnamelen` 为 0，则认定为默认数据库连接，就像在没有 AT 子句的 SQL 语句中一样。
